---
title: 创建以太网络的接入层
published: 2024-11-13
category: ["其他课程基础", "无线网络应用"]
tags: ["网络"]
alias: "creatingethernetaccesslayer"
---

## 一、交换机的功能

交换机（switch）是接入层的多端口设备，可以将多台主机连接到网络。

当一主机发送消息到连接在交换机的另一主机时，交换机将接受并拆包解码的数据帧，以读取消息的目的主机MAC地址部分，然后在MAC地址表（也叫做交换表）中查找端口做出转发决定。

交换机上的MAC地址表：

1. 所有活动端口。
2. 所有与这些活动端口相连的主机的MAC地址。

当消息在主机之间发送时，交换机将检查目的MAC地址是否存在MAC地址表中。如果存在，交换机就会在源端口与目的端口之间创建一个临时连接，称为电路。这一新电路为两台主机的通信提供一个专用通道。连接到该交换机的其他主机不会共享此通道的带宽，也不会接受那些并非发送给他们的消息。主机间每次通信都会创建一条新的独立电路，这些电路使交换机上多个通信可以同时进行，而不会发生冲突使数据损坏。

如果交换机收到的帧是发送到尚未列入MAC地址表的新主机，交换机就没有创建电路所需的信息。当交换机无法确定目的主机位置即所连端口时，就会采用“泛洪”（flooding）的方式将消息转发到所有连接着的主机。每台主机都将消息中的目的MAC地址与其自己的MAC地址进行比较，但只有其地址与目的地址相同即匹配的主机才会处理该消息并响应发送方。

交换机检查主机之间发送的每个帧的源MAC地址，然后创建MAC地址表条目。当新主机发送消息或响应“泛洪”式消息时，交换机就会立即获取其MAC地址及其连接的端口。交换机每次读取新的源MAC地址时，地址表都会自动更新。交换机通过这种方式可迅速学习到所有相连主机的MAC地址。

当一个网络中两个或多个设备同时发送消息，组成消息的电子信号在物理介质中相遇时，会相互影响并被损坏，这就是发生了冲突。冲突会造成消息损坏，无法被主机所理解。在有限网络中，通过后退等待重发来解决冲突的问题，这是以太网的CSMA/CD机制。WLAN中解决冲突的机制是CSMA/CA机制，事前避免同时发送。

## 二、广播消息与交换机

在本地网络中，某台主机需要将消息同时发送到所有其它主机可以通过“广播”消息来实现。

当主机需要查找信息，但又不确切了解其它主机可以提供的信息时，广播也非常有用。广播消息的特征是发送到所有主机都能识别的唯一MAC地址⎯⎯广播MAC地址，它是一个全部由1组成的48位地址。由于MAC地址通常用十六进制表示，所以广播MAC地址为FF-FF-FF-FF-FF-FF，其中每个F代表二进制中的四个1（即十进制中的15）。

当一台主机接收到发送给广播地址的消息时，它会接受并处理该消息，就像该消息时直接发送给它的一样。接收：能到它这里而已；接受：收到后会拆包看到里面的内容。

当某台主机发出一条广播消息时，交换机会将该消息转发到同一本地网络连接的每台主机。

本地网络也称为广播域。广播域是指当其内任意一台主机发送广播消息时，能够被其内的所有其他主机都接受下来的网络设备集合（网络区域）

从上面内容可以得出结论：交换机延伸广播域。

## 三、ARP协议

在本地网络中，仅当帧所包含的目的MAC地址与某主机的MAC地址相同或是广播MAC地址时，该主机才会接受该帧。

但网络应用常依靠目的IP地址表示网络位置，故需要一种机制来实现；已知IP地址找到MAC地址。发送主机使用地址解析协议（ARP）来发现同一本地网络中已知IP地址的任何主机的MAC地址。

ARP发现和存储主机MAC地址分为三步：

1. 发送主机创建并发送一个广播帧，该帧以广播MAC地址作为其目的地址。帧中的消息含有想知道的目的主机的IP地址。
2. 网络中每台主机都会收到该广播帧，并将消息中的目的IP地址与自己IP地址进行比较。两者相匹配的主机会将其MAC地址传回给原始发送主机。
3. 发送主机收到回送消息后，将该MAC地址和IP地址信息成对地存储到其ARP表中。

使用`arp -a`来输出ARP表。