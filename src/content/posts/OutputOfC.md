---
title: "C/C++的读入与输出"
published: 2024-10-30
category: ["程设计科", "编程语言"]
tags: ["C/C++"]
alias: "outputofc"
---

[card title="注意" color="info"]无特殊说明，本文中的读入数据来自键盘，输出到屏幕。[/card]

### 一、`printf()`用法（格式输入函数）

1. `printf()`函数主要用于输出，它可以将格式化的数据输出到屏幕上，让我们能够清晰地看到程序运行的结果。

2. `printf()`是在标准库的头文件`stdio.h`定义的，使用这个函数之前，必须在源码文件头部引入这个头文件（`#include<stdio.h>`）

3. `printf()`不会在尾行自动添加换行符，运行结束后，光标就停留在输出结束的地方，不会自动换行。

4. `printf()`返回值是整数，是输出字符的个数。

    ```c
    int count = printf("ni hao csdn,%d\n",111);
    //这里的格式化字符串包括逗号、空格、换行符、字母及数字共计16个字符
    printf("%d",n);
    //输出:16
    ```

5. `printf()`括号中使用引号来输出文本。

    ```c
    printf("Hello World!");
    //输出:Hello World
    ```

6. `printf()`可以在输出文本中指定占位符。所谓“占位符”就是这个位置可以用其他值代入。

    ```c
    printf("text %d 666%d",a,b);
    //输出整型a的值、一个空格、666和整型b的值
    ```
   
|  **占位符**  |  **内容**  |
| :------: | :------: |
|   %a   | 十六进制浮点数，字母输出为小写|
|   %A   | 十六进制浮点数，字母输出为大写|
|   %c   | 字符|
|   %d   | 十进制整数|
|   %e   | 使用科学计数法的浮点数，指数部分的e为小写|
|   %E   | 使用科学计数法的浮点数，指数部分的E为大写|
|   %i   | 整数，基本等同于%d|
|   %f   | 浮点数（float类型）|
|  %lf   | 浮点数（double类型）|
|   %g   | 6个有效数字的浮点数，整数部分一旦超过6位，就会自动转为科学计数法，指数部分的e为小写|
|   %G   | 等同于%g，唯一的区别是指数部分的E为大写|
|  %hd   | 十进制short int类型|
|  %ho   | 八进制 short int类型|
|  %hx   | 十六进制short int类型|
|  %hu   | unsigned short int类型|
|  %ld   | 十进制long int类型|
|  %lo   | 八进制long int类型|
|   %x   | 十六进制long int类型|
|  %lu   | unsigned long int类型|
|  %lld  | 十进制long long int类型|
|  %llo  | 八进制long long int类型|
|  %llx  | 十六进制long long int类型|
|  %llu  | unsigned long long int 类型|
|  %Le   | 科学计数法表示的long double类型浮点数|
|  %Lf   | long double类型浮点数|
|   %n   | 已输出的字符串数量。该占位符本身不输出，只将值存储在指定变量之中|
|   %o   | 八进制整数|
|   %p   | 指针|
|   %s   | 字符串|
|   %u   | 无符号整数|
|   %x   | 十六进制整数|
|  %zd   | size_t类型|
|   %%   | 输出一个百分号|

8. `printf()`允许限定占位符的最小宽度。

    ```c
    int a=12;
    printf("%5d",a);
    //输出:  123
    ```

    上面示例中，`%5d`表示这个占位符的宽度至少是5位。如果不满5位，对应的值在前面会添加空格。输出的值默认是右对齐，即输出内容前面会有空格，如果希望改为左对齐，可以在占位符的百分号的后面插入一个`-`号。

    ```c
    int a=12,b=21;
    printf("%-5d%d",a,b);
    //输出:12   21
    ```

    对于小数，这个限定符会限制所有数字的最小显示宽度。

    ```c
    printf("%12f",123.45);
    //输出:  123.450000
    ```

    上面示例中，%12f表示输出的浮点数最少要占据12位。由于小数的默认显示精度是小数点后6位，所以123.45输出结果的头部会添加2个空格，小数点也占一个字符的位置。

9. 默认情况下，`printf()`不对正数显示+号，只对负数显示号。如果想让正数也输出+号，可以在占位符的%后面加一个`+`。

    ```c
    printf("%+d",123);
    //输出:+123
    ```

10. 输出小数时，有时希望限定小数的位数。举例来说，希望小数点后面只保留两位，占位符可以写成`%.2f`。保留的方式是四舍五入，而非直接取整。这种写法可以与限定宽度占位符，结合使用。

    ```c
    printf("%.2f|%.3f|%6.1f",12.3,1.2345,123);
    //输出:12.30|1.235| 123.0
    ```

    最小宽度和小数位数这两个限定值，都可以用`*`代替，通过`printf()`的参数传入。

    ```c
    printf("%*.*f\n",6,2,0.5);//等同于printf("%6.2f\n",0.5);
    ```

11. `%s`占位符用来输出字符串，默认是全部输出。如果只想输出开头的部分，可以用`%.[m]s`指定输出的长度，其中`[m]`代表一个数字，表示所要输出的长度。

    ```c
    printf("%.5s\n", "hello world");
    //输出:Hello
    ```

### 二、`scanf`用法（格式输入函数）

1. `scanf()`函数主要用于输入，它可以从键盘上读取用户输入的数据，并将其存储到程序中定义的变量中。

2. `scanf()`是在标准库的头文件`stdio.h`定义的，使用这个函数之前，必须在源码文件头部引入这个头文件（`#include<stdio.h>`）

3. 它的第一个参数是一个格式字符串，里面会放置占位符（与`printf()`的占位符基本一致），告诉编译器如何解读用户的输入，需要提取的数据是什么类型。

   这是因为C语言的数据都是有类型的，`scanf()`必须提前知道用户输入的数据类型，才能处理数据。它的其余参数就是存放用户输入的变量，格式字符串里面有多少个占位符，就有多少个变量。

   ```c
   scanf("%d",&i);
   ```

   上面示例中，`scanf()`的第一个参数`%d`，表示用户输入的应该是一个整数。`%d`就是一个占位符，`%`是占位符的标志，`d`表示整数。第二个参数`&i`表示，将用户从键盘输入的整数存入变量`i`。

   注意：变量前面必须加上`&`运算符（指针变量除外），也叫取地址符，因为`scanf()`传递的不是值，而是地址（可以利用于数组、字符串的输入），即将变量的地址指向用户输入的值。 如果这里的变量是指针变量（比如字符串变量），那就不用加`&`运算符。

4. `scanf()`处理数值占位符时，会自动过滤空白字符，包括空格、制表符、换行符等。所以，用户输入的数据之间，有一个或多个空格不影响`scanf()`解读数据。另外，用户使用回车键，将输入分成几行，也不影响解读。

5. `scanf()`处理用户输入的原理是，用户的输入先放入缓存，等到按下回车键后，按照占位符对缓存进行解读。解读用户输入时，会从上一次解读遗留的第一个字符开始，直到读完缓存，或者遇到第一个不符合条件的字符为止。

6. `scanf()`函数的返回值是一个整数，它表示成功匹配和赋值的输入项数。具体来说，`scanf()`会根据提供的格式字符串读取输入，并尝试将输入的值赋给相应的变量。对于每一个成功匹配和赋值的输入项，`scanf()`的返回值都会增加。具体规则如下：

   1. 成功匹配的输入项数：如果格式字符串中有三个`%`格式说明符，并且`scanf()`成功地从输入中读取并匹配了三个值，那么它将返回3。
   2. 遇到不匹配或非法输入：如果输入与格式字符串不匹配，或者输入了非法字符（比如对于`%d`期望一个整数，但输入了一个字符），`scanf()` 可能会停止读取并返回已经成功匹配的输入项数。例如，如果格式字符串是`"%d %d"`但输入是`"123abc"`，`scanf() `只会读取123并返回1。
   3. 到达文件结束或输入结束：如果`scanf()`在读取任何输入之前就遇到了文件结束（EOF）或输入结束（比如在命令行中输入了Ctrl+D（在 Unix/Linux/macOS 上）或Ctrl+Z（在 Windows 上）），它将返回EOF（通常是-1）。
   4. 没有匹配任何输入项：如果`scanf()`的格式字符串与输入完全不匹配，它将返回0。

7. `%c`不忽略空白字符，总是返回当前第一个字符，无论该字符是否为空格。如果要强制跳过字符前的空白字符，可以写成`scanf(" %c",&ch)`，即`%c`前加上一个空格，表示跳过零个或多个空白字符。

8. 对于占位符`%s`，它其实不能简单地等同于字符串。它的规则是，从当前第一个非空白字符开始读起，直到遇到空白字符（即空格、换行符、制表符等）为止。因为`%s`不会包含空白字符，所以无法用来读取多个单词，除非多个`%s`一起使用。这也意味着，`scanf()`不适合读取可能包含空格的字符串，比如书名或歌曲名。

9. `scanf()`遇到`%s`占位符，会在字符串变量末尾存储一个空字符`\0`。

10. `scanf()`将字符串读入字符数组时，不会检测字符串是否超过了数组长度。所以，储存字符串时，很可能会超过数组的边界，导致预想不到的结果。为了防止这种情况，使用`%s`占位符时，有时指定读入字符串的最长长度，即写成`%[m]s`，其中的`[m]`是一个整数，表示读取字符串的最大长度，后面的字符将被丢弃。

11. `scanf()`提供了一个赋值忽略符`*`，只要把`*`加在任何占位符的百分号后面，该占位符就不会返回值，解析后将被丢弃。

    ```c
    scanf("%d%*c%d%*c%d"，&year,&month,&day);
    //无论输入是2024-10-30，还是2024/10/30，最后保存的都是year=2024,month=10,day=30
    ```

### 三、`getchar()`与`putchar()`

1. 在C语言中，`getchar()`和`putchar()`是用于字符输入和输出的两个函数。相比于其他读取方式，它们的效率更高，原因在于它们不需要格式转换。

2. 这些函数都包含在头文件`stdio.h`中，在使用时需要包含此头文件。

3. `getchar()`函数用于从输入流中读取下一个字符，并返回该字符，返回的是其 ASCII 值（作为整数），它不需要任何参数。如果发生错误或达到输入的末尾（例如从文件中读取时），`getchar()` 返回特殊值 `EOF`，通常定义为 `-1`。

   ```c
   ch = getchar(); // 读取一个字符
   ```

4. `putchar()`函数用于输出一个字符到输出流，它的参数是要打印的字符。将输出的字符作为 `unsigned char` 类型返回，如果发生错误，则返回 `EOF`。

   ```c
   putchar(ch); // 打印字符ch
   ```

5. 联系`scanf()`的读入特点，使用`getchar()`时，如果之前使用了`scanf()`，可能会在输入行留下一个换行符。这可以通过以下方式处理：

   ```c
   //有多个：
   while(getchar() != '\n') continue;
   //只有一个的话多写一个getchar()即可
   ```

### 四、`gets()`与`puts()`

1. 在C语言中，`gets()`和`puts()`是两个用于处理字符串输入和输出的标准库函数。这两个函数都在`stdio.h`头文件中声明。

2. `gets()`函数用于从键盘读取字符串，直到遇到换行符（回车键）为止，读取到空格不停止，并且不保留换行符。只要`gets()`遇到换行符，即便它是输入的第一个字符，`gets()`也会停止读入并返回（注意`scanf()`函数不读入换行符的特点）。如果输入的第一个字符就是换行符，则字符串将被置为空串。换行符本身不会被读取到字符串中。这个函数允许用户输入包含空格的字符串，并且会在字符串的末尾自动添加一个空字符（`'\0'`），从而形成一个完整的字符串。

   ```c
   char s[300];
   gets(s);
   //读入字符，从s[0]开始一个字符一个坑，填到数组中
   ```

3. `gets()`函数不会检查数组的边界，因此可能会导致缓冲区溢出的安全问题。为了避免这个问题，可以使用`fgets()`函数，它允许指定最大读取字符数，以确保不会超出数组的边界。

4. `gets()`如果正常读入（未遇到文件结尾，读入空串也是正常读入）则返回字符串，即返回字符串首地址（`char*`类型），如果遇到文件结尾，返回NULL。

5. `puts()`函数用于向屏幕写入字符串，并在输出后自动添加一个换行符。`puts()`函数相比`printf()`函数，只能输出字符串，不能进行格式化输出。

   ```c
   char s[] = "Hello World!";
   puts(s);
   //输出:
   //Hello World!
   //
   ```

6. `puts()`函数返回一个整数值，表示输出到控制台的字符数。由于`puts()`函数在输出字符串后会添加一个换行符，所以返回的整数值通常是字符串中字符的数量加1。

### 五、`fgets()`

1. 前文`fget()`是`gets()`的进化版本，比`gets()`更加安全。

2. `fgets()`有三个参数，分别是：读入的字符保存在哪里、读取字符的数量、从哪里读取。

   ```c
   char a[100];
   fgets(a,100,stdin);
   //译为向a中读入100个字符，stdin表示标准输入流，一般都使用stdin
   ```

3. `fgets()`函数用于从键盘读取字符串，直到遇到换行符（回车键）为止，读取到空格不停止，但是保留换行符。只要`fgets()`遇到换行符，即便它是输入的第一个字符，`fgets()`也会停止读入并返回（注意`scanf()`函数不读入换行符的特点）。

4. `fget()`函数中的第二个变量设定的字符数量如果小于字符串的长度，那么字符串将会被截取；如果大于字符串的长度则多余的部分系统会自动用空字符`'\0'`填充。

